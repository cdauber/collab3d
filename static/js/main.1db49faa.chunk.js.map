{"version":3,"sources":["ConfirmResolve/ConfirmResolve.js","redux/actions.js","CommentsColumn/CommentInput/CommentInput.js","CommentsColumn/Comment/TopRow/ProfileIcon/ProfileIcon.js","CommentsColumn/Comment/TopRow/TopRow.js","comments.js","redux/store.js","CommentsColumn/CommentsColumnHeader/CommentsColumnHeader.js","CommentsColumn/Comment/Comment.js","CommentsColumn/MainComment/MainComment.js","CommentsColumn/MainThread/MainThread.js","CommentsColumn/Thread/Thread.js","CommentsColumn/CommentsColumn.js","DrawCanvas/DrawCanvas.js","DrawOver/DrawOver.js","Header/Header.js","ModelRenderer.js","VariationsColumn/Variation/Variation.js","VariationsColumn/VariationsColumn.js","index.js"],"names":["ConfirmResolve","isModalOpen","onCancel","onResolve","props","id","className","onClick","event","stopPropagation","moveCamera","cameraPosition","type","data","selectComment","comment","deselectComment","unattachDrawOver","unattachPin","cancelComment","resolveComment","connect","isCommenting","fileIsAttached","file","drawOverIsAttached","drawing","pinIsAttached","pin","cancelEnabled","submitEnabled","selectedCommentId","beginComment","attachFile","unattachFile","attachDrawOver","attachPin","dispatchProps","ownProps","stateProps","onFocusTextArea","onBlurTextArea","length","onClickAttachFile","onClickAttachDrawOver","onClickAttachPin","onClickCancel","pinAttachable","mainThread","onClickSubmit","useState","inputComment","setInputComment","placeholder","value","onChange","target","onFocus","onBlur","data-tip","src","alt","place","effect","disabled","ProfileIcon","author","split","filter","_","i","names","map","name","toLocaleUpperCase","join","addDays","date","days","result","Date","valueOf","setDate","getDate","TopRow","profilePicture","redrawEnabled","onRedraw","closeMenu","setCloseMenu","useEffect","dateInMillis","today","toDateString","toLocaleTimeString","navigator","language","timeStyle","toLocaleDateString","dateStyle","relativeDateString","trigger","position","on","closeOnDocumentClick","closeOnEscape","arrow","getTime","text","drawOver","camera","focus","activeVariationIds","1","thread","2","3","4","CURSOR","INITIAL_CAMERA_POSITION","initialState","cursor","showPins","maxCommentId","variations","thumbnail","model","comments","cameraPositionEquals","camera1","camera2","every","p","Math","abs","f","createStore","state","selectedComment","find","JSON","parse","LZString","decompressFromEncodedURIComponent","reply","attachedFile","attachedPin","compressToEncodedURIComponent","stringify","activeThreadId","repinEnabled","dispatch","onRepin","headerText","iconImage","selected","children","onClickReply","openThread","replyLabel","onAddComment","onClickComment","onResolveComment","resolveCommentId","setResolveCommentId","key","flatMap","onReturn","resolveReply","onAddReply","addReply","restOfDispatchProps","e","activeThread","handleUndo","isPainting","setPainting","line","slice","handleClick","ref","nativeEvent","offsetX","offsetY","x","current","clientWidth","y","clientHeight","handleDrag","currLine","convertTouchToMouse","handler","canvasRect","getBoundingClientRect","touch","targetTouches","pageX","left","pageY","top","DrawCanvas","lineWidth","lineColor","useRef","ctx","setContext","getContext","canvas","clearRect","width","height","rest","lineJoin","lineCap","strokeStyle","beginPath","moveTo","lineTo","stroke","paint","allowChanges","keyMap","undo","handlers","onMouseDown","onMouseMove","onMouseUp","onTouchStart","onTouchMove","onTouchEnd","onTouchCancel","interactive","updateDrawing","Header","eyeOpen","onClickEye","alert","Model","path","fallback","setModel","a","async","Promise","resolve","reject","GLTFLoader","load","undefined","gltf","mroot","scene","bbox","Box3","setFromObject","scale","multiplyScalar","max","getSize","Vector3","toArray","copy","getCenter","object","Pin","pinPosition","color","mesh","geometry","verticesNeedUpdate","normal","endVertex","clone","addScaledVector","points","attach","vertices","visible","args","Controls","onOrbitChange","controlsRef","useFrame","controls","set","update","addEventListener","removeEventListener","useThree","domElement","gl","LoadingModel","loadingModel","setLoadingModel","setLength","rotation","extend","OrbitControls","onPointerMove","point","face","placePinClick","modelPath","pinFollowCursor","fov","near","onCreated","outputEncoding","sRGBEncoding","background","Color","minDistance","maxDistance","mouseHover","setMouseHover","onMouseEnter","onMouseLeave","selectVariation","variation","deselectVariation","onClickVariation","WrappedMainPage","activeVariations","Object","keys","variationId","onClickTopCamera","onClickFrontCamera","onClickSideCamera","hidePins","style","ReactDOM","render","store","document","getElementById"],"mappings":"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","file":"static/js/main.1db49faa.chunk.js","sourcesContent":["import React from \"react\";\r\nimport \"./ConfirmResolve.css\";\r\n\r\nexport function ConfirmResolve({ isModalOpen, onCancel, onResolve, ...props }) {\r\n  return (\r\n    <div id=\"modal\" className={isModalOpen ? \"\" : \"hide\"} onClick={onCancel}>\r\n      <div\r\n        id=\"modal-dialog\"\r\n        onClick={event => event.stopPropagation()}\r\n        {...props}\r\n      >\r\n        <span id=\"modal-warning\">Are you sure you want to resolve?</span>\r\n        <div id=\"modal-actions\">\r\n          <span\r\n            id=\"modal-cancel\"\r\n            onClick={event => {\r\n              event.stopPropagation();\r\n              onCancel();\r\n            }}\r\n          >\r\n            Cancel\r\n          </span>\r\n          <span\r\n            id=\"modal-submit\"\r\n            onClick={event => {\r\n              event.stopPropagation();\r\n              onResolve();\r\n            }}\r\n          >\r\n            Submit\r\n          </span>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n","/**\r\n * action types\r\n */\r\n\r\nexport const CHANGE_CAMERA = \"CHANGE_CAMERA\";\r\nexport const MOVE_CAMERA = \"MOVE_CAMERA\";\r\nexport const SELECT_COMMENT = \"SELECT_COMMENT\";\r\nexport const DESELECT_COMMENT = \"DESELECT_COMMENT\";\r\n\r\nexport const BEGIN_COMMENT = \"BEGIN_COMMENT\";\r\nexport const ATTACH_FILE = \"ATTACH_FILE\";\r\nexport const UNATTACH_FILE = \"UNATTACH_FILE\";\r\nexport const ATTACH_DRAW_OVER = \"ATTACH_DRAW_OVER\";\r\nexport const UNATTACH_DRAW_OVER = \"UNATTACH_DRAW_OVER\";\r\nexport const ATTACH_PIN = \"ATTACH_PIN\";\r\nexport const UNATTACH_PIN = \"UNATTACH_PIN\";\r\nexport const CANCEL_COMMENT = \"CANCEL_COMMENT\";\r\n\r\nexport const PLACE_PIN = \"PLACE_PIN\";\r\nexport const SET_PIN_POSITION = \"SET_PIN_POSITION\";\r\n\r\nexport const ADD_COMMENT = \"ADD_COMMENT\";\r\nexport const ADD_REPLY = \"ADD_REPLY\";\r\nexport const RESOLVE_COMMENT = \"RESOLVE_COMMENT\";\r\nexport const RESOLVE_REPLY = \"RESOLVE_REPLY\";\r\n\r\nexport const OPEN_THREAD = \"OPEN_THREAD\";\r\nexport const CLOSE_THREAD = \"CLOSE_THREAD\";\r\n\r\nexport const UPDATE_DRAWING = \"UPDATE_DRAWING\";\r\nexport const UPDATE_PIN = \"UPDATE_PIN\";\r\n\r\nexport const SELECT_VARIATION = \"SELECT_VARIATION\";\r\nexport const DESELECT_VARIATION = \"DESELECT_VARIATION\";\r\n\r\nexport const SHOW_PINS = \"SHOW_PINS\";\r\nexport const HIDE_PINS = \"HIDE_PINS\";\r\n\r\n/**\r\n * action creators\r\n */\r\n\r\nexport function changeCamera(cameraPosition) {\r\n  return { type: CHANGE_CAMERA, data: cameraPosition };\r\n}\r\nexport function moveCamera(cameraPosition) {\r\n  return { type: MOVE_CAMERA, data: cameraPosition };\r\n}\r\n\r\nexport function selectComment(comment) {\r\n  return { type: SELECT_COMMENT, data: comment };\r\n}\r\nexport function deselectComment() {\r\n  return { type: DESELECT_COMMENT };\r\n}\r\n\r\nexport function beginComment() {\r\n  return { type: BEGIN_COMMENT };\r\n}\r\nexport function attachFile() {\r\n  return { type: ATTACH_FILE };\r\n}\r\nexport function unattachFile() {\r\n  return { type: UNATTACH_FILE };\r\n}\r\nexport function attachDrawOver() {\r\n  return { type: ATTACH_DRAW_OVER };\r\n}\r\nexport function unattachDrawOver() {\r\n  return { type: UNATTACH_DRAW_OVER };\r\n}\r\nexport function attachPin() {\r\n  return { type: ATTACH_PIN };\r\n}\r\nexport function unattachPin() {\r\n  return { type: UNATTACH_PIN };\r\n}\r\nexport function setPinPosition(pinLocation) {\r\n  return { type: SET_PIN_POSITION, data: pinLocation };\r\n}\r\nexport function placePin() {\r\n  return { type: PLACE_PIN };\r\n}\r\n\r\nexport function cancelComment() {\r\n  return { type: CANCEL_COMMENT };\r\n}\r\n\r\nexport function addComment(text) {\r\n  return { type: ADD_COMMENT, data: text };\r\n}\r\nexport function addReply(comment, text) {\r\n  return { type: ADD_REPLY, data: { comment, text } };\r\n}\r\nexport function resolveComment(comment) {\r\n  return { type: RESOLVE_COMMENT, data: comment };\r\n}\r\nexport function resolveReply(comment, reply) {\r\n  return { type: RESOLVE_REPLY, data: { comment, reply } };\r\n}\r\n\r\nexport function openThread(comment) {\r\n  return { type: OPEN_THREAD, data: comment };\r\n}\r\nexport function closeThread() {\r\n  return { type: CLOSE_THREAD };\r\n}\r\n\r\nexport function updateDrawing(drawing) {\r\n  return { type: UPDATE_DRAWING, data: drawing };\r\n}\r\nexport function updatePin(pin) {\r\n  return { type: UPDATE_PIN, data: pin };\r\n}\r\n\r\nexport function selectVariation(variation) {\r\n  return { type: SELECT_VARIATION, data: variation };\r\n}\r\nexport function deselectVariation(variation) {\r\n  return { type: DESELECT_VARIATION, data: variation };\r\n}\r\n\r\nexport function showPins() {\r\n  return { type: SHOW_PINS };\r\n}\r\nexport function hidePins() {\r\n  return { type: HIDE_PINS };\r\n}\r\n","import React, { useState } from \"react\";\r\nimport TextareaAutosize from \"react-autosize-textarea/lib\";\r\nimport { connect } from \"react-redux\";\r\nimport ReactTooltip from \"react-tooltip\";\r\nimport {\r\n  attachDrawOver,\r\n  attachFile,\r\n  attachPin,\r\n  beginComment,\r\n  cancelComment,\r\n  deselectComment,\r\n  unattachDrawOver,\r\n  unattachFile,\r\n  unattachPin\r\n} from \"../../redux/actions\";\r\nimport \"./CommentInput.css\";\r\n\r\nfunction CommentInput({\r\n  pinAttachable = false,\r\n  mainThread = false,\r\n  fileIsAttached,\r\n  drawOverIsAttached,\r\n  pinIsAttached,\r\n  cancelEnabled,\r\n  submitEnabled,\r\n  onFocusTextArea,\r\n  onBlurTextArea,\r\n  onClickAttachFile,\r\n  onClickAttachDrawOver,\r\n  onClickAttachPin,\r\n  onClickCancel,\r\n  onClickSubmit = () => {},\r\n  ...props\r\n}) {\r\n  const [inputComment, setInputComment] = useState();\r\n\r\n  return (\r\n    <div className=\"comment-input-column\" {...props}>\r\n      <TextareaAutosize\r\n        className=\"comment-input-text-area\"\r\n        placeholder=\"Add a comment\"\r\n        value={inputComment}\r\n        onChange={event => setInputComment(event.target.value)}\r\n        onFocus={onFocusTextArea}\r\n        onBlur={() => onBlurTextArea(inputComment)}\r\n      />\r\n      <div className=\"comment-input-actions-row\">\r\n        <div className=\"comment-input-icon-actions\">\r\n          <button\r\n            className={\r\n              \"comment-input-icon-action-button\" +\r\n              (fileIsAttached ? \" active\" : \"\")\r\n            }\r\n            data-tip=\"Attach file\"\r\n            onClick={() => onClickAttachFile(inputComment)}\r\n          >\r\n            <img src=\"assets/clip.svg\" alt=\"File attachment icon\" />\r\n          </button>\r\n          <button\r\n            className={\r\n              \"comment-input-icon-action-button\" +\r\n              (drawOverIsAttached ? \" active\" : \"\")\r\n            }\r\n            data-tip=\"Drawover\"\r\n            onClick={() => onClickAttachDrawOver(inputComment)}\r\n          >\r\n            <img src=\"assets/pencil.svg\" alt=\"File attachment icon\" />\r\n          </button>\r\n          {pinAttachable && (\r\n            <button\r\n              className={\r\n                \"comment-input-icon-action-button\" +\r\n                (pinIsAttached ? \" active\" : \"\")\r\n              }\r\n              data-tip=\"Pin\"\r\n              onClick={() => onClickAttachPin(inputComment)}\r\n            >\r\n              <img src=\"assets/pin.svg\" alt=\"File attachment icon\" />\r\n            </button>\r\n          )}\r\n          <ReactTooltip\r\n            className=\"comment-input-tooltip\"\r\n            place=\"bottom\"\r\n            effect=\"solid\"\r\n          />\r\n        </div>\r\n        <div className=\"comment-input-text-actions\">\r\n          <button\r\n            className=\"comment-input-text-action-button comment-input-cancel-button\"\r\n            disabled={\r\n              !(cancelEnabled || (inputComment && inputComment.length > 0))\r\n            }\r\n            onClick={() => {\r\n              setInputComment(\"\");\r\n              onClickCancel();\r\n            }}\r\n          >\r\n            Cancel\r\n          </button>\r\n          <button\r\n            className=\"comment-input-text-action-button comment-input-submit-button\"\r\n            disabled={\r\n              !(submitEnabled || (inputComment && inputComment.length > 0))\r\n            }\r\n            onClick={() => {\r\n              onClickSubmit(inputComment || \"\");\r\n              setInputComment(\"\");\r\n            }}\r\n          >\r\n            Submit\r\n          </button>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nfunction mergeProps(\r\n  { selectedCommentId, ...stateProps },\r\n  dispatchProps,\r\n  ownProps\r\n) {\r\n  const {\r\n    deselectComment,\r\n    beginComment,\r\n    attachFile,\r\n    unattachFile,\r\n    attachDrawOver,\r\n    unattachDrawOver,\r\n    attachPin,\r\n    unattachPin,\r\n    cancelComment\r\n  } = dispatchProps;\r\n\r\n  return {\r\n    ...ownProps,\r\n    ...stateProps,\r\n    onFocusTextArea: () => {\r\n      if (!stateProps.isCommenting) {\r\n        if (selectedCommentId) {\r\n          deselectComment();\r\n        }\r\n        beginComment();\r\n      }\r\n    },\r\n    onBlurTextArea: comment =>\r\n      !stateProps.fileIsAttached &&\r\n      !stateProps.drawOverIsAttached &&\r\n      !stateProps.pinIsAttached &&\r\n      (!comment || comment.length === 0) &&\r\n      cancelComment(),\r\n    onClickAttachFile: comment => {\r\n      if (stateProps.fileIsAttached) {\r\n        if (\r\n          !stateProps.drawOverIsAttached &&\r\n          !stateProps.pinIsAttached &&\r\n          (!comment || comment.length === 0)\r\n        ) {\r\n          cancelComment();\r\n        } else {\r\n          unattachFile();\r\n        }\r\n      } else {\r\n        if (!stateProps.cancelEnabled) {\r\n          deselectComment();\r\n          beginComment();\r\n        }\r\n        attachFile();\r\n      }\r\n    },\r\n    onClickAttachDrawOver: comment => {\r\n      if (stateProps.drawOverIsAttached) {\r\n        if (\r\n          !stateProps.fileIsAttached &&\r\n          !stateProps.pinIsAttached &&\r\n          (!comment || comment.length === 0)\r\n        ) {\r\n          cancelComment();\r\n        } else {\r\n          unattachDrawOver();\r\n        }\r\n      } else {\r\n        if (!stateProps.cancelEnabled) {\r\n          deselectComment();\r\n          beginComment();\r\n        }\r\n        attachDrawOver();\r\n      }\r\n    },\r\n    onClickAttachPin: comment => {\r\n      if (stateProps.pinIsAttached) {\r\n        if (\r\n          !stateProps.fileIsAttached &&\r\n          !stateProps.drawOverIsAttached &&\r\n          (!comment || comment.length === 0)\r\n        ) {\r\n          cancelComment();\r\n        } else {\r\n          unattachPin();\r\n        }\r\n      } else {\r\n        if (!stateProps.cancelEnabled) {\r\n          deselectComment();\r\n          beginComment();\r\n        }\r\n        attachPin();\r\n      }\r\n    },\r\n    onClickCancel: () => cancelComment()\r\n  };\r\n}\r\n\r\nexport default connect(\r\n  ({\r\n    isCommenting,\r\n    fileIsAttached,\r\n    file,\r\n    drawOverIsAttached,\r\n    drawing,\r\n    pinIsAttached,\r\n    pin,\r\n    selectedCommentId\r\n  }) => ({\r\n    fileIsAttached,\r\n    drawOverIsAttached,\r\n    pinIsAttached,\r\n    cancelEnabled: isCommenting,\r\n    submitEnabled:\r\n      (fileIsAttached && file) ||\r\n      (drawOverIsAttached && drawing) ||\r\n      (pinIsAttached && pin),\r\n    selectedCommentId\r\n  }),\r\n  {\r\n    deselectComment,\r\n    beginComment,\r\n    attachFile,\r\n    unattachFile,\r\n    attachDrawOver,\r\n    unattachDrawOver,\r\n    attachPin,\r\n    unattachPin,\r\n    cancelComment\r\n  },\r\n  mergeProps\r\n)(CommentInput);\r\n","import React from \"react\";\r\nimport \"./ProfileIcon.css\";\r\n\r\nexport function ProfileIcon({ src, author }) {\r\n  return src ? (\r\n    <img className=\"profile-picture\" src={src} alt={author} />\r\n  ) : (\r\n    <div className=\"initials\">\r\n      {author\r\n        .split(\" \")\r\n        .filter((_, i, names) => i === 0 || i === names.length - 1)\r\n        .map(name => name[0].toLocaleUpperCase())\r\n        .join(\"\")}\r\n    </div>\r\n  );\r\n}\r\n","import React, { useEffect, useState } from \"react\";\r\nimport Popup from \"reactjs-popup\";\r\nimport { ProfileIcon } from \"./ProfileIcon/ProfileIcon\";\r\nimport \"./TopRow.css\";\r\n\r\nexport function addDays(date, days) {\r\n  const result = new Date(date.valueOf());\r\n  result.setDate(date.getDate() + days);\r\n  return result;\r\n}\r\n\r\nfunction relativeDateString(dateInMillis) {\r\n  const today = new Date();\r\n  const date = new Date(dateInMillis);\r\n\r\n  if (today.toDateString() === date.toDateString()) {\r\n    return `${date.toLocaleTimeString(navigator.language, {\r\n      timeStyle: \"short\"\r\n    })} Today`;\r\n  } else if (today.toDateString() === addDays(date, 1).toDateString()) {\r\n    return \"Yesterday\";\r\n  } else {\r\n    return date.toLocaleDateString(navigator.language, { dateStyle: \"medium\" });\r\n  }\r\n}\r\n\r\nexport function TopRow({\r\n  profilePicture,\r\n  author,\r\n  date,\r\n  redrawEnabled,\r\n  onRedraw,\r\n  onResolve\r\n}) {\r\n  const [closeMenu, setCloseMenu] = useState(false);\r\n\r\n  useEffect(() => {\r\n    if (closeMenu) {\r\n      setCloseMenu(false);\r\n    }\r\n  }, [closeMenu, setCloseMenu]);\r\n\r\n  return (\r\n    <div className=\"comment-top-row\">\r\n      <ProfileIcon src={profilePicture} author={author} />\r\n      <div className=\"comment-top-column\">\r\n        <div className=\"author-name\">{author}</div>\r\n        <div className=\"comment-date\">{relativeDateString(date)}</div>\r\n      </div>\r\n      {redrawEnabled && (\r\n        <button\r\n          className=\"top-row-redo-button\"\r\n          onClick={onRedraw}\r\n        >\r\n          Redraw\r\n        </button>\r\n      )}\r\n      <Popup\r\n        className=\"top-row-popup\"\r\n        trigger={\r\n          <button className=\"small-icon-button\">\r\n            <img src=\"assets/dots.svg\" alt=\"More options icon\" />\r\n          </button>\r\n        }\r\n        position=\"bottom right\"\r\n        on=\"click\"\r\n        closeOnDocumentClick\r\n        closeOnEscape\r\n        disabled={closeMenu}\r\n        arrow={false}\r\n      >\r\n        <div className=\"top-row-menu\">\r\n          <div className=\"top-row-menu-options-row\">\r\n            Options\r\n            <button className=\"small-icon-button\">\r\n              <img\r\n                src=\"assets/close.svg\"\r\n                alt=\"Close menu icon\"\r\n                onClick={() => setCloseMenu(true)}\r\n              />\r\n            </button>\r\n          </div>\r\n          <div\r\n            onClick={() => {\r\n              setCloseMenu(true);\r\n              onResolve();\r\n            }}\r\n          >\r\n            Resolve\r\n          </div>\r\n          <div onClick={() => setCloseMenu(true)}>Edit</div>\r\n          <div\r\n            onClick={() => {\r\n              setCloseMenu(true);\r\n              onResolve();\r\n            }}\r\n          >\r\n            Delete\r\n          </div>\r\n        </div>\r\n      </Popup>\r\n    </div>\r\n  );\r\n}\r\n","import { addDays } from \"./CommentsColumn/Comment/TopRow/TopRow\";\r\n\r\nexport default [\r\n  {\r\n    id: 1,\r\n    author: \"Steve Singh\",\r\n    profilePicture:\r\n      \"https://media-exp1.licdn.com/dms/image/C5103AQES2HWYu834NA/profile-displayphoto-shrink_800_800/0?e=1588809600&v=beta&t=crKDuzgclc_52hqw_qvzN5O-vvGJUYWLxiCXwvPUa60\",\r\n    date: new Date().getTime(),\r\n    text:\r\n      \"I think the outsole of the shoes is a bit too thick. Should we make it 1/4 inch smaller?\",\r\n    drawOver:\r\n      \"NrDeCIA9wLgBgHQA45IMwDYCcBWAjGnAExZylYA04AnrIgCz05ZFIDsLccbZGS9AXwoRo8BGyQ40aHEQxo8srtiq0xjLGyY5JpYnIxCRdceizscOekRxs8rPKpNM4aJHgwc3WBSRxGoEwlXH3kMJkU2NiIndXw4PAkFPDwUWSIA0UQozyxzLlJMeh9YhnS9NnkZdgk2TKC2NCI4HXQyFHMcUoQmEjkiVjhwjESCerEovHpULAwpInoCJm7elgwBlGHRtHHsvjsZejYpejQomJpnKzxzI6akBes64UCJjGwPK2PiDgSVq3Q9HWOASKQeu3EcxwfHQSAw3CwKS6lzi9EBwNBqQyLyykLOdk46DQWCOyLUZS+3EqjTyRHshhxQRGmhBrhaeXQGH+IyG7H0FXCEMqCWCbNYxM83K0hDpuCiQKwQtaMpJBBkqSlp2IN1sWmwSrm-A8WhQQKQSH+jQ4iUwcLR6yVJFIC1mWkRHH+KEUcjsx1sNiVxBJ6FSkg8cHonrmU1SpFOKSiQrREbhA00jHNaCj+EWSDjyUTjImTBQLvkdNOiP+LAsPCqLTwriTjC+7Gsc3hWZRZRrxzr0gbTaL2XbuvYxOKjTJV1pmHC9jpZ0Ew-E0zhqGw60bZGn6nhlnMikkqGpQuJ+AU8OiI0IFu7PX3zHcOhB7E8Z9I8lwqSOEcsKxGHVXVsWZFFwM9r2wfBnxLLl7yBFJcGAjgRmYfwVynX9XGmRZiiOADUiaIZG32Ygdgwpp5RGYEbWiAj0GaHlSKIcjjAmBQ3xSdYZBJNx6KIpi+RYoVWEaKY82hOwEguckHwWPg6SIDgtEWSwRMsOFUzzB4XwA+SHnsZTGEUdC2OyBYWMRKwuGkDg71koF9MUozVNM15zJuFgSRBFgeEqPSzWc9NXKFG4SGOJSVRBLsHPWQLDOCkzQu+IYd1Ycx5AAhQIyKWQRhQJBQtQkhlDQRZuF3Bh5EbU5wjy1JUAhPh8EsZh91jLQAJJDs0UkYp8uXMyEHeAYWwzbxmBi5xjhuVAJW66E3NxdZJGg0b3jyRIVmfWQsTkQh8whNDb1vdNGxYFZETIRYNqQ8SlpMaEoWiNViFsFJulfORNHPKYOUKlcAR0KIhnmSt7MeyKpB4bShiOZ4hqkPkmBkbxmkwT7KS0RJQL8Vj3IQKRpAIbB8lmc0IbEHRo2mKYmlUxEjtyhjwgkKQpm6TsWjK9UpmigHEZLFhWDbOQHkje98twTw4siLcjs8ZRrDpdwes5pc-y9PK7AFgnmEYdoZh0BRbE5kFDLkWQJIlJqWJ5HVKg7Okzd2+QI2mCMSUVFcaZWxpci8tgzZyVApAqjhGZ9xpSWsNEQa0GSTHeSJKgVPgvKa7yJON8M0SmsQRv4cwWFSTwrAeiYLOJRQPds8xOfnAYCC0TWEiVHms8sWvHEl1mdHStUFHAjCzAsKwbDsBwG7K9dKxrnxddxdwuFOFjFzzVBKcQOZZmwGwuAGIoISNHxCk8TBERsM2CDyeIQX92Rj74RgPdsLuEgl2Swkqfg4XeaorDH1CKCTk69JCc1QFMGw9Noz2DwBCUgthCDQkwBFWYlB7z92IryHgaY24riugMEg7h+rznzogSwb1GDRGkCSfaCCkR1kKFZTyn0hh5DdNYTQNpsRDWdCTaI7hIoqHgoXVkG0WgHGPgnfgLRtQe0UCsM4-IuCVGkMDBkQ1JDVUcrYD+JR4K+E0DwWc7xFjH0IDDRQG12CaDgg5IxINTHziFJwRoKBKhyFrisI4zRGxnFGsLCu2Rf7rnHtEEu9iriLFuI0VgjwlICAALpJKAA\",\r\n    camera: {\r\n      position: [4.097174371429141, -0.12701280783257413, -0.4438805208056621],\r\n      focus: [0, 0, 0]\r\n    },\r\n    activeVariationIds: { 1: true },\r\n    thread: []\r\n  },\r\n  {\r\n    id: 2,\r\n    author: \"Ed Lazowska\",\r\n    profilePicture:\r\n      \"https://s3-us-west-2.amazonaws.com/www-cse-public/images/portraits/lazowska_sm.jpg\",\r\n    date: addDays(new Date(), -1).getTime(),\r\n    text:\r\n      \"Do you think the lining should be a different color? Should we try another material? Maybe more velvet-looking fabrics.\",\r\n    camera: {\r\n      position: [\r\n        -0.01780035071461352,\r\n        1.7964346779471398,\r\n        0.012150211120563803\r\n      ],\r\n      focus: [-0.07562892676508104, 0, -2.054163283050633]\r\n    },\r\n    activeVariationIds: { 1: true, 2: true, 3: true, 4: true },\r\n    thread: []\r\n  },\r\n  {\r\n    id: 3,\r\n    author: \"Dan Levitan\",\r\n    profilePicture:\r\n      \"https://dukeangelnetwork.duke.edu/wp-content/uploads/2015/05/Dan-Levitan-Headshot.jpg\",\r\n    date: addDays(new Date(), -2).getTime(),\r\n    text:\r\n      \"If I remember correctly, the merchandise team wants to get rid of the heel collar pull tab, right? But I’m pretty open to it. What do you think?\",\r\n    drawOver:\r\n      \"NrDeCIA9wLgBgHQFYDsBOJAOJcCM-cAWANiQBpwBPWRAZjiTXWONt3VwCY4MBfMiNHjIscTrhaZmjOJgrVhbdnELZCeTJlxJi-QTREoutTklxxamQt07yDbTrULmGKQiiRJVugVAOfVFBQVcU4g1TtFXFpiaNMeUksGPT9hT3pMPE5CWiRaFCtcSLoibLR1TmJy-DRMFKFET3YTZy8sNAZCYoQ2T3FidzQawjyUev9CNDRc1usUNmxutmJ0S2muJmC0H300yYsqphYhiKp7dhy4FVUsMwtxvZRiTDROTXDK6aXcKTFODrgT1ouTQD0aIxenDeUmsz2yS24sTgz2CUIBbjByEII2xqFq7ky+QRP0w-w6qgs6DCmK8MRIEm4L1YbARvSQjh0tW4kxpc3cLG480wtCYCJwrFYlWxT1qvJ4ODc1imUiwCKqKBsGCGwPcNJFxAsFi8KimRgRmkysNGLwwO1SjRF2ny2MqpM0aARGAkqFJLFYmj1pPSlTu+GFSzY1kmHnEJkphD1AywJgGBTyRAjnw13LYYmmCd8DWQuU8U1kGoORTOimB23KpAGmi85T1+WI-1kzykbgjRhwEgN7JeVj1bwG+2myKNEasUOcXGCGoLuwd2gkBW4uSXcmrdHUwNksnEGvdevMK32NrwLCW6m2VUY9bEWjtRaHpOiA2yjAvt+c-LEfAVB+FYaTefJBVzV5GFsXcemlYUPEsR08WXe1kEqLhGBIEZ2yrBQ90wA1OiCEw3iCMD3A3fIdGiBwljMIgcEsddpheSiTBeHDsnbWgGPYLQflqe8CnYMDTDjMdxUYfD7FpUwhVQXAuVyMDnywZT5mVFAGOqKinlJaYKMLfxlOFFhzCIng8B0uCYmRX40SuIE0LfdgZHUZScDRcg7JYZwoWiNwVCwGl2CIGp6CMIgciWZ44yRFE-lBEy0m0VZVGcJ4Q2IJY+zwJQeHPVgwtUcp8QkFQNVkxQ3GeLyTACHRhTCmYNRjUhGCcPKrFqNwjBuIjX1M9yjTcIZ23KJZDLMKowmCEYdCQMKVDERsfw8WRptiEwdXzKxYhpTtXAyKECmeab1n+IIeFeGJhrSZEQXZZSuHwEglgwCwX1WF42FoI7+x+aIbMcXK7K5El4qVfqjrCBtgORHRLG6dQITwdkVnc1AAdSxo8Cyl4XokRY4LvCx6C5aZ21UI7nI0VgSae1GuFjYL0adTFJm2bhNhyIJxBqxB-1ZoK0dEbQuaYZ0DPZBaXlR7lhUGaWCeSPGEEmVNWAVLsCncRX6DeZ9GwWRwpYNMIGG2ExlFMRXLjEIULJyFqNcmTwgmwQE8lkaNFeebFSVMf9afd+tVgVCChl8gjNfoMQvFTBhhWwKWSEjwFo+0VGHE2W6wYGXApfyTJpmuoZxEBXPLGsUxsGE+KpehbITBtkwPFsuP+eS5zmSwJ4pbMkU2-cPJnFR-8PAOyx2TCOpw8spozD+iVJ-ZV4Bid4VUAe4WOh+YI13mVBr0noYeByLKiCkVT3Y-PufhCJgMFR5XBypBJ0i59A1D6Vf67dDMB0YUdYSA6FUAvFcmtU5HHQD6TCpM44BEBFwAUjVaJSzMGOZwt8phMC6HBLAJAGCxHmEEbCnAwog3ekRLC2I+JEIwM4fE8w3jZByHqawb1lQh2DkApk9YIFNi1jSdsyJBheC0FCC6RCWC-SupsYuGt2hDH6rWEY5RCHIOBPlMwzZZASExEiOi54tBBA8EA64G9cLiCIilaB7Ywj4AfJtAy4Nu4VnMJpX2IZtjGNtrhCWkwvLr3+FKbeW494IAlP6H25lKgihZk4KyOQY6TEsAElgSRp4xESR6Oys5HBGVqG6LCxi3jmAknRZ8uRbxWRImw8iYwNaDlehSfA8xFrfEcM4K4qAx5SOiaIVQuQCD0AYbHewVwXjImyA5b0wz-RkIwNgrQKM7LW2YIzDgvNloqOIVsR8wIyTfBiHEHA2w8iZGWgAXVuUAA\",\r\n    camera: {\r\n      position: [2.5618038056469907, 2.450867014776206, -1.6792127301384934],\r\n      focus: [-0.5957711016470664, 0, -1.5276489458495608]\r\n    },\r\n    activeVariationIds: { 2: true },\r\n    thread: []\r\n  }\r\n];\r\n","import LZString from \"lz-string\";\r\nimport { createStore } from \"redux\";\r\nimport comments from \"../comments\";\r\nimport {\r\n  ADD_COMMENT,\r\n  ADD_REPLY,\r\n  ATTACH_DRAW_OVER,\r\n  ATTACH_FILE,\r\n  ATTACH_PIN,\r\n  BEGIN_COMMENT,\r\n  CANCEL_COMMENT,\r\n  CHANGE_CAMERA,\r\n  CLOSE_THREAD,\r\n  DESELECT_COMMENT,\r\n  DESELECT_VARIATION,\r\n  HIDE_PINS,\r\n  MOVE_CAMERA,\r\n  OPEN_THREAD,\r\n  PLACE_PIN,\r\n  RESOLVE_COMMENT,\r\n  RESOLVE_REPLY,\r\n  SELECT_COMMENT,\r\n  SELECT_VARIATION,\r\n  SET_PIN_POSITION,\r\n  SHOW_PINS,\r\n  UNATTACH_DRAW_OVER,\r\n  UNATTACH_FILE,\r\n  UNATTACH_PIN,\r\n  UPDATE_DRAWING\r\n} from \"./actions\";\r\n\r\nexport const CURSOR = {\r\n  DEFAULT: \"pointer\",\r\n  DRAWOVER: \"drawover\",\r\n  PIN: \"pin\"\r\n};\r\n\r\nexport const INITIAL_CAMERA_POSITION = [0, 1, 4];\r\n\r\nconst initialState = {\r\n  cursor: CURSOR.DEFAULT,\r\n  cameraPosition: { position: INITIAL_CAMERA_POSITION, focus: [0, 0, 0] },\r\n  isCommenting: false,\r\n  fileIsAttached: false,\r\n  drawOverIsAttached: false,\r\n  pinIsAttached: false,\r\n  showPins: true,\r\n  maxCommentId: 3,\r\n  activeVariationIds: { 1: true },\r\n  variations: [\r\n    {\r\n      id: 1,\r\n      name: \"Grey Sneaker\",\r\n      thumbnail: \"assets/adidas_sneaker_thumbnail.png\",\r\n      model: \"models/gltf/adidas_sneaker/scene.gltf\"\r\n    },\r\n    {\r\n      id: 2,\r\n      name: \"Lavender Sneaker\",\r\n      thumbnail: \"assets/adidas_sneaker_lavender_thumbnail.png\",\r\n      model: \"models/gltf/adidas_sneaker_lavender/Project Name.gltf\"\r\n    },\r\n    {\r\n      id: 3,\r\n      name: \"Pink Sneaker\",\r\n      thumbnail: \"assets/adidas_sneaker_pink_thumbnail.png\",\r\n      model: \"models/gltf/adidas_sneaker_pink/Project Name.gltf\"\r\n    },\r\n    {\r\n      id: 4,\r\n      name: \"Dark Blue Sneaker\",\r\n      thumbnail: \"assets/adidas_sneaker_dark_blue_thumbnail.png\",\r\n      model: \"models/gltf/adidas_sneaker_dark_blue/Project Name.gltf\"\r\n    },\r\n    // {\r\n    //   id: 5,\r\n    //   name: \"Grey Jacket\",\r\n    //   thumbnail: \"assets/grey_adidas_thumbnail.png\",\r\n    //   model: \"models/gltf/grey_adidas/Grey Adidas.gltf\"\r\n    // },\r\n    // {\r\n    //   id: 6,\r\n    //   name: \"Blue Jacket\",\r\n    //   thumbnail: \"assets/blue_adidas_thumbnail.png\",\r\n    //   model: \"models/gltf/blue_adidas/Blue Adidas.gltf\"\r\n    // },\r\n    // {\r\n    //   id: 7,\r\n    //   name: \"Pink Jacket\",\r\n    //   thumbnail: \"assets/pink_adidas_thumbnail.png\",\r\n    //   model: \"models/gltf/pink_adidas/Pink Jacket.gltf\"\r\n    // }\r\n  ],\r\n  comments: comments\r\n};\r\n\r\nexport function cameraPositionEquals(camera1, camera2) {\r\n  return (\r\n    camera1 === camera2 ||\r\n    (camera1 &&\r\n      camera2 &&\r\n      camera1.position.every(\r\n        (p, i) => Math.abs(p - camera2.position[i]) < 1e-10\r\n      ) &&\r\n      camera1.focus.every((f, i) => Math.abs(f - camera2.focus[i]) < 1e-10))\r\n  );\r\n}\r\n\r\nfunction rootReducer(state = initialState, { type, data }) {\r\n  switch (type) {\r\n    case CHANGE_CAMERA:\r\n      const selectedComment = state.comments.find(\r\n        ({ id }) => id === state.selectedCommentId\r\n      );\r\n      if (\r\n        selectedComment &&\r\n        !cameraPositionEquals(selectedComment.camera, data)\r\n      ) {\r\n        return {\r\n          ...state,\r\n          cameraPosition: data,\r\n          selectedCommentId: null,\r\n          drawing: null\r\n        };\r\n      }\r\n      return { ...state, cameraPosition: data };\r\n    case MOVE_CAMERA:\r\n      return { ...state, cameraPosition: data };\r\n    case SELECT_COMMENT:\r\n      return {\r\n        ...state,\r\n        selectedCommentId: data.id,\r\n        cameraPosition: data.camera ? data.camera : state.cameraPosition,\r\n        activeVariationIds: data.activeVariationIds\r\n          ? data.activeVariationIds\r\n          : state.activeVariationIds,\r\n        drawing:\r\n          data.drawOver &&\r\n          JSON.parse(LZString.decompressFromEncodedURIComponent(data.drawOver))\r\n      };\r\n    case DESELECT_COMMENT:\r\n      return { ...state, selectedCommentId: null, drawing: null };\r\n    case RESOLVE_COMMENT:\r\n      return {\r\n        ...state,\r\n        comments: state.comments.filter(({ id }) => id !== data.id)\r\n      };\r\n    case RESOLVE_REPLY:\r\n      return {\r\n        ...state,\r\n        comments: state.comments.map(comment =>\r\n          comment.id === data.comment.id\r\n            ? {\r\n                ...comment,\r\n                thread: comment.thread.filter(({ id }) => id !== data.reply.id)\r\n              }\r\n            : comment\r\n        )\r\n      };\r\n    case BEGIN_COMMENT:\r\n      return { ...state, isCommenting: true };\r\n    case ATTACH_FILE:\r\n      return { ...state, fileIsAttached: true };\r\n    case UNATTACH_FILE:\r\n      return { ...state, fileIsAttached: false, attachedFile: null };\r\n    case ATTACH_DRAW_OVER:\r\n      return { ...state, drawOverIsAttached: true, cursor: CURSOR.DRAWOVER };\r\n    case UNATTACH_DRAW_OVER:\r\n      return {\r\n        ...state,\r\n        drawOverIsAttached: false,\r\n        drawing: null,\r\n        cursor: CURSOR.DEFAULT\r\n      };\r\n    case ATTACH_PIN:\r\n      return {\r\n        ...state,\r\n        pinIsAttached: true,\r\n        cursor: CURSOR.PIN\r\n      };\r\n    case UNATTACH_PIN:\r\n      return {\r\n        ...state,\r\n        pinIsAttached: false,\r\n        attachedPin: null,\r\n        cursor: CURSOR.DEFAULT\r\n      };\r\n    case SET_PIN_POSITION:\r\n      return { ...state, pin: data };\r\n    case PLACE_PIN:\r\n      return { ...state, cursor: CURSOR.DEFAULT };\r\n    case CANCEL_COMMENT:\r\n      return {\r\n        ...state,\r\n        isCommenting: false,\r\n        fileIsAttached: false,\r\n        attachedFile: null,\r\n        drawOverIsAttached: false,\r\n        drawing: null,\r\n        pinIsAttached: false,\r\n        pin: null,\r\n        cursor: CURSOR.DEFAULT\r\n      };\r\n    case ADD_COMMENT:\r\n      return {\r\n        ...state,\r\n        maxCommentId: 1 + state.maxCommentId,\r\n        comments: [\r\n          {\r\n            id: 1 + state.maxCommentId,\r\n            author: \"Greg Gottesman\",\r\n            profilePicture:\r\n              \"https://assets.website-files.com/5d3152346d95065922960b3a/5db769036b1dff3418bffd20_Greg.jpg\",\r\n            date: new Date().getTime(),\r\n            text: data,\r\n            file: state.file,\r\n            drawOver:\r\n              state.drawing &&\r\n              LZString.compressToEncodedURIComponent(\r\n                JSON.stringify(state.drawing)\r\n              ),\r\n            pin: state.pin,\r\n            camera: state.cameraPosition,\r\n            activeVariationIds: state.activeVariationIds,\r\n            thread: []\r\n          },\r\n          ...state.comments\r\n        ]\r\n      };\r\n    case ADD_REPLY:\r\n      return {\r\n        ...state,\r\n        maxCommentId: 1 + state.maxCommentId,\r\n        comments: state.comments.map(comment =>\r\n          comment.id === data.comment.id\r\n            ? {\r\n                ...comment,\r\n                thread: [\r\n                  {\r\n                    id: 1 + state.maxCommentId,\r\n                    author: \"Greg Gottesman\",\r\n                    profilePicture:\r\n                      \"https://assets.website-files.com/5d3152346d95065922960b3a/5db769036b1dff3418bffd20_Greg.jpg\",\r\n                    date: new Date().getTime(),\r\n                    text: data.text,\r\n                    file: state.file,\r\n                    drawOver: LZString.compressToEncodedURIComponent(\r\n                      JSON.stringify(state.drawing)\r\n                    )\r\n                  },\r\n                  ...comment.thread\r\n                ]\r\n              }\r\n            : comment\r\n        )\r\n      };\r\n    case OPEN_THREAD:\r\n      return { ...state, activeThreadId: data.id };\r\n    case CLOSE_THREAD:\r\n      return { ...state, activeThreadId: null };\r\n    case UPDATE_DRAWING:\r\n      return { ...state, drawing: data };\r\n    case SELECT_VARIATION:\r\n      return {\r\n        ...state,\r\n        activeVariationIds: { ...state.activeVariationIds, [data.id]: true }\r\n      };\r\n    case DESELECT_VARIATION:\r\n      return {\r\n        ...state,\r\n        activeVariationIds: { ...state.activeVariationIds, [data.id]: false }\r\n      };\r\n    case SHOW_PINS:\r\n      return { ...state, showPins: true };\r\n    case HIDE_PINS:\r\n      return { ...state, showPins: false };\r\n    default:\r\n      return state;\r\n  }\r\n}\r\n\r\nexport default createStore(rootReducer);\r\n","import React from \"react\";\r\nimport { connect } from \"react-redux\";\r\nimport { unattachDrawOver, unattachPin } from \"../../redux/actions\";\r\nimport { CURSOR } from \"../../redux/store\";\r\nimport \"./CommentsColumnHeader.css\";\r\n\r\nfunction CommentsColumnHeader({\r\n  headerText,\r\n  iconImage,\r\n  className,\r\n  redrawEnabled,\r\n  repinEnabled,\r\n  onRedraw,\r\n  onRepin,\r\n  ...props\r\n}) {\r\n  return (\r\n    <div\r\n      className={\r\n        \"comments-column-header-row\" + (className ? \" \" + className : \"\")\r\n      }\r\n      {...props}\r\n    >\r\n      <div>\r\n        {iconImage && (\r\n          <img\r\n            className=\"comments-column-header-icon-image\"\r\n            src={iconImage}\r\n            alt=\"Back icon\"\r\n          />\r\n        )}\r\n        <span className=\"comments-column-header-text\">{headerText}</span>\r\n      </div>\r\n      {!iconImage && redrawEnabled && (\r\n        <button\r\n          className=\"comments-column-header-redo-button\"\r\n          onClick={onRedraw}\r\n        >\r\n          Redraw\r\n        </button>\r\n      )}\r\n      {!iconImage && repinEnabled && (\r\n        <button\r\n          className=\"comments-column-header-redo-button\"\r\n          onClick={onRepin}\r\n        >\r\n          Repin\r\n        </button>\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default connect(\r\n  ({ cursor, drawing, pin }) => ({\r\n    redrawEnabled: cursor === CURSOR.DRAWOVER && drawing,\r\n    repinEnabled: cursor === CURSOR.PIN && pin\r\n  }),\r\n  dispatch => ({\r\n    onRedraw: () => {\r\n      dispatch(unattachDrawOver());\r\n    },\r\n    onRepin: () => {\r\n      dispatch(unattachPin());\r\n    }\r\n  })\r\n)(CommentsColumnHeader);\r\n","import React from \"react\";\r\nimport { connect } from \"react-redux\";\r\nimport \"./Comment.css\";\r\nimport { TopRow } from \"./TopRow/TopRow\";\r\nimport { CURSOR } from \"../../redux/store\";\r\nimport { unattachDrawOver } from \"../../redux/actions\";\r\n\r\nfunction Comment({\r\n  comment: { text, drawOver, pin, ...comment },\r\n  selected,\r\n  redrawEnabled,\r\n  onRedraw,\r\n  onResolve,\r\n  children,\r\n  ...props\r\n}) {\r\n  return (\r\n    <div className={\"comment\" + (selected ? \" selected\" : \"\")} {...props}>\r\n      <div className=\"comment-content\">\r\n        <TopRow\r\n          {...comment}\r\n          redrawEnabled={redrawEnabled}\r\n          onRedraw={onRedraw}\r\n          onResolve={onResolve}\r\n        />\r\n        <p className=\"comment-text\">{text}</p>\r\n        {children}\r\n      </div>\r\n      <div className=\"comment-flag-row\">\r\n        {drawOver && (\r\n          <img\r\n            className=\"comment-flag\"\r\n            src=\"assets/drawover-flag.svg\"\r\n            alt=\"Drawover flag\"\r\n          />\r\n        )}\r\n        {pin && (\r\n          <img\r\n            className=\"comment-flag\"\r\n            src=\"assets/pin-flag.svg\"\r\n            alt=\"Pin flag\"\r\n          />\r\n        )}\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default connect(\r\n  (\r\n    { cursor, activeThreadId, selectedCommentId, drawing },\r\n    { comment: { id } }\r\n  ) => ({\r\n    selected: id === selectedCommentId,\r\n    redrawEnabled:\r\n      id === activeThreadId && cursor === CURSOR.DRAWOVER && drawing\r\n  }),\r\n  dispatch => ({\r\n    onRedraw: () => {\r\n      dispatch(unattachDrawOver());\r\n    }\r\n  })\r\n)(Comment);\r\n","import React from \"react\";\r\nimport { connect } from \"react-redux\";\r\nimport { cancelComment, openThread, selectComment } from \"../../redux/actions\";\r\nimport Comment from \"../Comment/Comment\";\r\nimport \"./MainComment.css\";\r\n\r\nfunction MainComment({\r\n  comment: { thread, ...comment },\r\n  onClickReply,\r\n  ...props\r\n}) {\r\n  function replyLabel(thread) {\r\n    if (thread && thread.length > 0) {\r\n      if (thread.length > 1) {\r\n        return `${thread.length} Replies`;\r\n      } else {\r\n        return \"1 Reply\";\r\n      }\r\n    } else {\r\n      return \"Reply\";\r\n    }\r\n  }\r\n\r\n  return (\r\n    <Comment comment={comment} {...props}>\r\n      <button\r\n        className=\"reply-button\"\r\n        onClick={event => {\r\n          event.stopPropagation();\r\n          onClickReply();\r\n        }}\r\n      >\r\n        {replyLabel(thread)}\r\n      </button>\r\n    </Comment>\r\n  );\r\n}\r\n\r\nexport default connect(null, (dispatch, { comment }) => ({\r\n  onClickReply: () => {\r\n    dispatch(cancelComment());\r\n    dispatch(selectComment(comment));\r\n    dispatch(openThread(comment));\r\n  }\r\n}))(MainComment);\r\n","import React, { useState } from \"react\";\r\nimport { connect } from \"react-redux\";\r\nimport { ConfirmResolve } from \"../../ConfirmResolve/ConfirmResolve\";\r\nimport {\r\n  addComment,\r\n  cancelComment,\r\n  deselectComment,\r\n  resolveComment,\r\n  selectComment\r\n} from \"../../redux/actions\";\r\nimport CommentInput from \"../CommentInput/CommentInput\";\r\nimport CommentsColumnHeader from \"../CommentsColumnHeader/CommentsColumnHeader\";\r\nimport MainComment from \"../MainComment/MainComment\";\r\nimport \"./MainThread.css\";\r\n\r\nfunction MainThread({\r\n  isCommenting,\r\n  comments,\r\n  onAddComment,\r\n  onClickComment,\r\n  onResolveComment,\r\n  ...props\r\n}) {\r\n  const [resolveCommentId, setResolveCommentId] = useState();\r\n\r\n  return (\r\n    <div id=\"comment-column\" {...props}>\r\n      <div id=\"input-column\">\r\n        <CommentsColumnHeader headerText=\"Comments\" />\r\n        <CommentInput pinAttachable mainThread onClickSubmit={onAddComment} />\r\n      </div>\r\n      <div className={\"scroll-column\" + (isCommenting ? \" focused\" : \"\")}>\r\n        {comments.map(comment => (\r\n          <MainComment\r\n            key={comment.id}\r\n            comment={comment}\r\n            onClick={() => onClickComment(comment)}\r\n            onResolve={() => setResolveCommentId(comment.id)}\r\n          />\r\n        ))}\r\n        {isCommenting && <div id=\"comment-vignette\"></div>}\r\n      </div>\r\n      <ConfirmResolve\r\n        isModalOpen={resolveCommentId}\r\n        onCancel={() => setResolveCommentId(null)}\r\n        onResolve={() => {\r\n          onResolveComment(comments.find(({ id }) => id === resolveCommentId));\r\n          setResolveCommentId(null);\r\n        }}\r\n      />\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default connect(\r\n  ({ isCommenting, selectedCommentId, comments }) => ({\r\n    isCommenting,\r\n    selectedComment: comments.find(({ id }) => id === selectedCommentId),\r\n    comments\r\n  }),\r\n  dispatch => ({\r\n    onAddComment: comment => {\r\n      dispatch(addComment(comment));\r\n      dispatch(cancelComment());\r\n    },\r\n    selectComment: comment => dispatch(selectComment(comment)),\r\n    deselectComment: () => dispatch(deselectComment()),\r\n    resolveComment: comment => dispatch(resolveComment(comment))\r\n  }),\r\n  (\r\n    { selectedComment, ...stateProps },\r\n    { selectComment, deselectComment, resolveComment, ...dispatchProps },\r\n    ownProps\r\n  ) => ({\r\n    ...ownProps,\r\n    ...stateProps,\r\n    ...dispatchProps,\r\n    onClickComment: comment =>\r\n      comment !== selectedComment ? selectComment(comment) : deselectComment(),\r\n    onResolveComment: comment => {\r\n      if (comment === selectedComment) {\r\n        deselectComment();\r\n      }\r\n      resolveComment(comment);\r\n    }\r\n  })\r\n)(MainThread);\r\n","import React, { useState } from \"react\";\r\nimport { connect } from \"react-redux\";\r\nimport { ConfirmResolve } from \"../../ConfirmResolve/ConfirmResolve\";\r\nimport {\r\n  addReply,\r\n  cancelComment,\r\n  closeThread,\r\n  deselectComment,\r\n  resolveComment,\r\n  resolveReply,\r\n  selectComment\r\n} from \"../../redux/actions\";\r\nimport Comment from \"../Comment/Comment\";\r\nimport CommentInput from \"../CommentInput/CommentInput\";\r\nimport CommentsColumnHeader from \"../CommentsColumnHeader/CommentsColumnHeader\";\r\nimport \"./Thread.css\";\r\n\r\nfunction Thread({\r\n  comment,\r\n  isCommenting,\r\n  onReturn,\r\n  onClickComment,\r\n  onClickReply,\r\n  onAddReply,\r\n  onResolveComment,\r\n  ...props\r\n}) {\r\n  const [resolveCommentId, setResolveCommentId] = useState();\r\n\r\n  return comment ? (\r\n    <div id=\"thread-column\" {...props}>\r\n      <CommentsColumnHeader\r\n        className=\"thread-column-header\"\r\n        iconImage=\"assets/left-arrow.svg\"\r\n        headerText=\"Back to all comments\"\r\n        onClick={onReturn}\r\n      />\r\n      <Comment\r\n        comment={comment}\r\n        onClick={() => onClickComment(comment)}\r\n        onResolve={() => setResolveCommentId(comment.id)}\r\n      >\r\n        <CommentInput\r\n          onClick={e => e.stopPropagation()}\r\n          onClickSubmit={text => onAddReply(comment, text)}\r\n        />\r\n      </Comment>\r\n      <div className=\"scroll-column\">\r\n        {comment &&\r\n          comment.thread.map(reply => (\r\n            <Comment\r\n              key={reply.id}\r\n              comment={reply}\r\n              onClick={() => onClickReply(reply)}\r\n              onResolve={() => setResolveCommentId(reply.id)}\r\n            />\r\n          ))}\r\n        {isCommenting && <div id=\"reply-vignette\"></div>}\r\n      </div>\r\n      <ConfirmResolve\r\n        isModalOpen={resolveCommentId}\r\n        onCancel={() => setResolveCommentId(null)}\r\n        onResolve={() => {\r\n          onResolveComment(\r\n            [comment, ...comment.thread].find(\r\n              ({ id }) => id === resolveCommentId\r\n            )\r\n          );\r\n          setResolveCommentId(null);\r\n        }}\r\n      />\r\n    </div>\r\n  ) : null;\r\n}\r\n\r\nfunction mergeProps(\r\n  { selectedComment, ...stateProps },\r\n  dispatchProps,\r\n  ownProps\r\n) {\r\n  const {\r\n    selectComment,\r\n    deselectComment,\r\n    resolveComment,\r\n    resolveReply,\r\n    ...restOfDispatchProps\r\n  } = dispatchProps;\r\n\r\n  return {\r\n    ...ownProps,\r\n    ...stateProps,\r\n    ...restOfDispatchProps,\r\n    onClickComment: comment => {\r\n      if (!stateProps.isCommenting && comment !== selectedComment) {\r\n        selectComment(comment);\r\n      }\r\n    },\r\n    onClickReply: comment =>\r\n      comment !== selectedComment ? selectComment(comment) : deselectComment(),\r\n    onResolveComment: comment => {\r\n      if (comment === selectedComment) {\r\n        deselectComment();\r\n      }\r\n      if (comment === ownProps.comment) {\r\n        resolveComment(comment);\r\n      } else {\r\n        resolveReply(ownProps.comment, comment);\r\n      }\r\n    }\r\n  };\r\n}\r\n\r\nexport default connect(\r\n  ({ isCommenting, selectedCommentId, comments }) => ({\r\n    isCommenting,\r\n    selectedComment: comments\r\n      .flatMap(comment => [comment, ...comment.thread])\r\n      .find(({ id }) => id === selectedCommentId)\r\n  }),\r\n  dispatch => ({\r\n    onReturn: () => {\r\n      dispatch(cancelComment());\r\n      dispatch(closeThread());\r\n    },\r\n    selectComment: comment => dispatch(selectComment(comment)),\r\n    deselectComment: () => dispatch(deselectComment()),\r\n    resolveComment: comment => dispatch(resolveComment(comment)),\r\n    resolveReply: (comment, reply) => dispatch(resolveReply(comment, reply)),\r\n    onAddReply: (comment, text) => {\r\n      dispatch(addReply(comment, text));\r\n      dispatch(cancelComment());\r\n    }\r\n  }),\r\n  mergeProps\r\n)(Thread);\r\n","import React from \"react\";\r\nimport { connect } from \"react-redux\";\r\nimport \"./CommentsColumn.css\";\r\nimport MainThread from \"./MainThread/MainThread\";\r\nimport Thread from \"./Thread/Thread\";\r\n\r\nfunction CommentsColumn({ activeThread, ...props }) {\r\n  return (\r\n    <div id=\"comments-row\">\r\n      <MainThread\r\n        className={\r\n          \"main-thread\" + (activeThread ? \" main-thread-inactive\" : \"\")\r\n        }\r\n        {...props}\r\n      />\r\n      <Thread\r\n        className={\r\n          \"active-thread\" + (!activeThread ? \" active-thread-inactive\" : \"\")\r\n        }\r\n        comment={activeThread}\r\n      />\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default connect(\r\n  ({ activeThreadId, comments }) => ({\r\n    activeThread: comments.find(({ id }) => id === activeThreadId)\r\n  }),\r\n  () => ({})\r\n)(CommentsColumn);\r\n","import React, { useEffect, useRef, useState } from \"react\";\r\nimport { HotKeys } from \"react-hotkeys\";\r\nimport \"./DrawCanvas.css\";\r\n\r\nfunction handleUndo(isPainting, setPainting, value, onChange) {\r\n  return () => {\r\n    if (isPainting) {\r\n      setPainting(false);\r\n    }\r\n    value = value.filter(line => line.length > 1);\r\n    if (value.length > 0) {\r\n      onChange && onChange(value.slice(0, value.length - 1));\r\n    }\r\n  };\r\n}\r\n\r\nfunction handleClick(setPainting, onChange, value, ref) {\r\n  return ({ nativeEvent }) => {\r\n    const { offsetX, offsetY } = nativeEvent;\r\n    setPainting(true);\r\n    onChange &&\r\n      onChange([\r\n        ...value,\r\n        [\r\n          {\r\n            x: offsetX / ref.current.clientWidth,\r\n            y: offsetY / ref.current.clientHeight\r\n          }\r\n        ]\r\n      ]);\r\n  };\r\n}\r\n\r\nfunction handleDrag(isPainting, value, onChange, ref) {\r\n  return ({ nativeEvent }) => {\r\n    if (isPainting) {\r\n      const { offsetX, offsetY } = nativeEvent;\r\n      if (value.length > 0) {\r\n        const currLine = value[value.length - 1];\r\n        onChange &&\r\n          onChange([\r\n            ...value.slice(0, value.length - 1),\r\n            [\r\n              ...currLine,\r\n              {\r\n                x: offsetX / ref.current.clientWidth,\r\n                y: offsetY / ref.current.clientHeight\r\n              }\r\n            ]\r\n          ]);\r\n      }\r\n    }\r\n  };\r\n}\r\n\r\nfunction convertTouchToMouse(handler) {\r\n  return ({ nativeEvent }) => {\r\n    const canvasRect = nativeEvent.target.getBoundingClientRect();\r\n    const touch = nativeEvent.targetTouches[0];\r\n    handler({\r\n      nativeEvent: {\r\n        offsetX: touch.pageX - canvasRect.left,\r\n        offsetY: touch.pageY - canvasRect.top\r\n      }\r\n    });\r\n  };\r\n}\r\n\r\nfunction paint(canvas, ctx, value, lineWidth, lineColor) {\r\n  if (ctx) {\r\n    ctx.clearRect(0, 0, canvas.width, canvas.height);\r\n\r\n    for (const line of value) {\r\n      const [{ x, y }, ...rest] = line;\r\n\r\n      ctx.lineJoin = \"round\";\r\n      ctx.lineCap = \"round\";\r\n      ctx.lineWidth = lineWidth;\r\n      ctx.strokeStyle = lineColor;\r\n\r\n      ctx.beginPath();\r\n      ctx.moveTo(x * canvas.width, y * canvas.height);\r\n      for (const { x, y } of rest) {\r\n        ctx.lineTo(x * canvas.width, y * canvas.height);\r\n      }\r\n      ctx.stroke();\r\n    }\r\n  }\r\n}\r\n\r\nexport function DrawCanvas({\r\n  lineWidth = 3,\r\n  lineColor = \"black\",\r\n  value,\r\n  onChange,\r\n  ...props\r\n}) {\r\n  value = value || [];\r\n  const ref = useRef();\r\n  const width = 1024;\r\n  const height = 1024;\r\n  const [ctx, setContext] = useState();\r\n  const [isPainting, setPainting] = useState(false);\r\n\r\n  useEffect(() => {\r\n    if (!ctx) {\r\n      setContext(ref.current.getContext(\"2d\"));\r\n    }\r\n  }, [ref, ctx]);\r\n  useEffect(() => paint(ref.current, ctx, value, lineWidth, lineColor), [\r\n    ref,\r\n    ctx,\r\n    value,\r\n    lineWidth,\r\n    lineColor\r\n  ]);\r\n\r\n  return (\r\n    <HotKeys\r\n      allowChanges\r\n      className=\"draw-canvas-hotkeys\"\r\n      keyMap={{ undo: [\"command+z\", \"ctrl+z\", \"backspace\"] }}\r\n      handlers={{\r\n        undo: handleUndo(isPainting, setPainting, value, onChange)\r\n      }}\r\n    >\r\n      <canvas\r\n        ref={ref}\r\n        className=\"draw-canvas\"\r\n        width={width}\r\n        height={height}\r\n        onMouseDown={handleClick(setPainting, onChange, value, ref)}\r\n        onMouseMove={handleDrag(isPainting, value, onChange, ref)}\r\n        onMouseUp={() => setPainting(false)}\r\n        onTouchStart={convertTouchToMouse(\r\n          handleClick(setPainting, onChange, value, ref)\r\n        )}\r\n        onTouchMove={convertTouchToMouse(\r\n          handleDrag(isPainting, value, onChange, ref)\r\n        )}\r\n        onTouchEnd={() => setPainting(false)}\r\n        onTouchCancel={handleUndo(isPainting, setPainting, value, onChange)}\r\n        {...props}\r\n      />\r\n    </HotKeys>\r\n  );\r\n}\r\n","import React from \"react\";\r\nimport { connect } from \"react-redux\";\r\nimport { DrawCanvas } from \"../DrawCanvas/DrawCanvas\";\r\nimport { updateDrawing } from \"../redux/actions\";\r\nimport { CURSOR } from \"../redux/store\";\r\nimport \"./DrawOver.css\";\r\n\r\nfunction DrawOver({ interactive, drawing, onChange, children, ...props }) {\r\n  return (\r\n    <div id=\"sketch-container\" {...props}>\r\n      {children}\r\n      <div id=\"sketch-canvas\" className={!interactive ? \"static\" : \"\"}>\r\n        <DrawCanvas\r\n          lineWidth={2}\r\n          lineColor=\"#ff0035\"\r\n          value={drawing}\r\n          onChange={onChange}\r\n        />\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default connect(\r\n  ({ cursor, drawing }) => ({\r\n    interactive: cursor === CURSOR.DRAWOVER,\r\n    drawing\r\n  }),\r\n  dispatch => ({ onChange: drawing => dispatch(updateDrawing(drawing)) })\r\n)(DrawOver);\r\n","import React from \"react\";\r\nimport \"./Header.css\";\r\n\r\nfunction Header({ eyeOpen, onClickEye }) {\r\n  return (\r\n    <div className=\"head\">\r\n      <button className=\"back-button\">Back</button>\r\n      <div className=\"button-row\">\r\n        <img\r\n          className=\"profile\"\r\n          alt=\"Greg\"\r\n          src=\"https://assets.website-files.com/5d3152346d95065922960b3a/5db769036b1dff3418bffd20_Greg.jpg\"\r\n        />\r\n        <button className=\"AR\" onClick={() => alert(\"more features to come\")}>\r\n          AR\r\n        </button>\r\n        <button className=\"share\" onClick={() => alert(\"share link copied\")}>\r\n          Share\r\n        </button>\r\n        <button className=\"eye\" onClick={onClickEye}>\r\n          <img\r\n            src={`assets/eye-${eyeOpen ? \"open\" : \"closed\"}.svg`}\r\n            alt=\"Show/hide pins icon\"\r\n          />\r\n        </button>\r\n      </div>\r\n      <div className=\"greeting-row\">\r\n        <span>Nike Zoom Prototype 1</span>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default Header;\r\n","import React, { useEffect, useRef, useState } from \"react\";\r\nimport { connect } from \"react-redux\";\r\nimport { Canvas, extend, useFrame, useThree } from \"react-three-fiber\";\r\nimport { Box3, Color, sRGBEncoding, Vector3 } from \"three\";\r\nimport { OrbitControls } from \"three/examples/jsm/controls/OrbitControls\";\r\nimport { GLTFLoader } from \"three/examples/jsm/loaders/GLTFLoader\";\r\nimport { changeCamera, placePin, setPinPosition } from \"./redux/actions\";\r\nimport {\r\n  cameraPositionEquals,\r\n  CURSOR,\r\n  INITIAL_CAMERA_POSITION\r\n} from \"./redux/store\";\r\n\r\nextend({ OrbitControls });\r\n\r\nfunction Model({ path, fallback, ...props }) {\r\n  const [model, setModel] = useState();\r\n\r\n  useEffect(() => {\r\n    if (!model) {\r\n      (async () => {\r\n        const gltf = await new Promise((resolve, reject) =>\r\n          new GLTFLoader().load(path, resolve, undefined, reject)\r\n        );\r\n        var mroot = gltf.scene;\r\n\r\n        //Rescale the object to normalized space\r\n        var bbox = new Box3().setFromObject(mroot);\r\n        mroot.scale.multiplyScalar(\r\n          5 / Math.max(...bbox.getSize(new Vector3()).toArray())\r\n        );\r\n\r\n        //Centering Object\r\n        bbox.setFromObject(mroot);\r\n        mroot.position.copy(bbox.getCenter(new Vector3())).multiplyScalar(-1);\r\n\r\n        setModel(gltf);\r\n      })();\r\n    }\r\n  }, [path, model]);\r\n\r\n  return model ? <primitive object={model.scene} {...props} /> : fallback;\r\n}\r\n\r\nfunction Pin({ pinPosition, color = \"red\" }) {\r\n  const mesh = useRef();\r\n\r\n  useEffect(() => {\r\n    if (mesh.current) {\r\n      mesh.current.geometry.verticesNeedUpdate = true;\r\n    }\r\n  });\r\n\r\n  if (!pinPosition) return null;\r\n\r\n  let position = new Vector3(...pinPosition.position);\r\n  let normal = new Vector3(...pinPosition.normal);\r\n\r\n  let endVertex = position.clone();\r\n  endVertex.addScaledVector(normal, 0.2); //length of pin\r\n\r\n  var points = [position, endVertex];\r\n\r\n  var pin = (\r\n    <group>\r\n      <line ref={mesh}>\r\n        <geometry\r\n          attach=\"geometry\"\r\n          vertices={points}\r\n          verticesNeedUpdate={true}\r\n        />\r\n        <meshBasicMaterial attach=\"material\" color=\"#7B7B7B\" />\r\n      </line>\r\n\r\n      <mesh visible position={points[1]}>\r\n        <sphereGeometry attach=\"geometry\" args={[0.03, 16, 16]} />\r\n        <meshStandardMaterial attach=\"material\" color={color} />\r\n      </mesh>\r\n    </group>\r\n  );\r\n\r\n  return pin;\r\n}\r\n\r\nfunction Controls({ cameraPosition, onOrbitChange, ...props }) {\r\n  const controlsRef = useRef();\r\n\r\n  useFrame(() => {\r\n    const controls = controlsRef.current;\r\n    if (\r\n      cameraPosition &&\r\n      !cameraPositionEquals(cameraPosition, {\r\n        position: controls.object.position.toArray(),\r\n        focus: controls.target.toArray()\r\n      })\r\n    ) {\r\n      const { position, focus } = cameraPosition;\r\n      controls.object.position.set(...position);\r\n      controls.target.set(...focus);\r\n      controls.update();\r\n    }\r\n  });\r\n\r\n  useEffect(() => {\r\n    const controls = controlsRef.current;\r\n    controls.addEventListener(\"change\", onOrbitChange);\r\n    return () => controls.removeEventListener(\"change\", onOrbitChange);\r\n  }, [cameraPosition, controlsRef, onOrbitChange]);\r\n\r\n  const {\r\n    camera,\r\n    gl: { domElement }\r\n  } = useThree();\r\n  return (\r\n    <orbitControls ref={controlsRef} args={[camera, domElement]} {...props} />\r\n  );\r\n}\r\n\r\nfunction LoadingModel({ color = \"orange\", position, ...props }) {\r\n  const mesh = useRef();\r\n  const [loadingModel, setLoadingModel] = useState();\r\n\r\n  useEffect(() => {\r\n    if (!loadingModel) {\r\n      (async () => {\r\n        const gltf = await new Promise((resolve, reject) =>\r\n          new GLTFLoader().load(\r\n            \"models/gltf/loading_model_2/Project Name.gltf\",\r\n            resolve,\r\n            undefined,\r\n            reject\r\n          )\r\n        );\r\n        gltf.scene.scale.setLength(13);\r\n        setLoadingModel(gltf);\r\n      })();\r\n    }\r\n  }, [loadingModel, setLoadingModel]);\r\n\r\n  useFrame(() => {\r\n    if (mesh.current) {\r\n      mesh.current.rotation.y -= 0.03;\r\n      mesh.current.position.set(...position);\r\n    }\r\n  });\r\n\r\n  return loadingModel ? (\r\n    <primitive ref={mesh} object={loadingModel.scene} {...props} />\r\n  ) : null;\r\n}\r\n\r\nfunction ModelRenderer({\r\n  cameraPosition,\r\n  comments,\r\n  modelPath,\r\n  pinIsAttached,\r\n  pinFollowCursor,\r\n  pin,\r\n  showPins,\r\n  onOrbitChange,\r\n  placePinClick,\r\n  onPointerMove,\r\n  ...props\r\n}) {\r\n  return (\r\n    <Canvas\r\n      camera={{ fov: 60, near: 1, position: INITIAL_CAMERA_POSITION }}\r\n      onCreated={({ gl, scene }) => {\r\n        if (gl) gl.outputEncoding = sRGBEncoding;\r\n        if (scene) scene.background = new Color(0xfafafa);\r\n      }}\r\n      {...props}\r\n    >\r\n      <Controls\r\n        cameraPosition={cameraPosition}\r\n        minDistance={1}\r\n        maxDistance={50}\r\n        onOrbitChange={onOrbitChange}\r\n      />\r\n      <ambientLight />\r\n      <Model\r\n        path={modelPath}\r\n        fallback={<LoadingModel position={cameraPosition.focus} />}\r\n        onPointerMove={pinFollowCursor && onPointerMove}\r\n        onClick={pinFollowCursor && placePinClick}\r\n      />\r\n      {pinIsAttached && <Pin pinPosition={pin} color=\"#E37FFA\" />}\r\n      {showPins &&\r\n        comments\r\n          .filter(comment => comment.pin)\r\n          .map(comment => <Pin key={comment.id} pinPosition={comment.pin} />)}\r\n    </Canvas>\r\n  );\r\n}\r\n\r\nexport default connect(\r\n  ({ cameraPosition, comments, pinIsAttached, cursor, pin, showPins }) => ({\r\n    cameraPosition,\r\n    comments,\r\n    // pinIsAttached,\r\n    // pinFollowCursor: cursor === CURSOR.PIN,\r\n    // pin,\r\n    // showPins\r\n  }),\r\n  dispatch => ({\r\n    onOrbitChange: ({\r\n      target: {\r\n        object: { position },\r\n        target: focus\r\n      }\r\n    }) =>\r\n      dispatch(\r\n        changeCamera({ position: position.toArray(), focus: focus.toArray() })\r\n      ),\r\n    onPointerMove: event =>\r\n      dispatch(\r\n        setPinPosition({\r\n          position: event.point.toArray(),\r\n          normal: event.face.normal.toArray()\r\n        })\r\n      ),\r\n    placePinClick: () => dispatch(placePin())\r\n  })\r\n)(ModelRenderer);\r\n","import React, { useState } from \"react\";\r\nimport \"./Variation.css\";\r\nimport { connect } from \"react-redux\";\r\n\r\nfunction Variation({ id, name, thumbnail, selected, ...props }) {\r\n  const [mouseHover, setMouseHover] = useState(false);\r\n\r\n  return (\r\n    <div\r\n      className=\"variation\"\r\n      onMouseEnter={() => setMouseHover(true)}\r\n      onMouseLeave={() => setMouseHover(false)}\r\n      {...props}\r\n    >\r\n      <span className=\"variation-name\">{name}</span>\r\n      <img\r\n        className=\"variation-thumbnail-image\"\r\n        src={thumbnail}\r\n        alt={`${name} thumbnail`}\r\n      />\r\n      {(selected || mouseHover) && (\r\n        <div\r\n          className={\"variation-checked-circle\" + (selected ? \" selected\" : \"\")}\r\n        >\r\n          {selected && (\r\n            <img\r\n              src=\"assets/variation-check.svg\"\r\n              alt=\"Variation checked icon\"\r\n            />\r\n          )}\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default connect(\r\n  ({ activeVariationIds }, ownProps) => ({\r\n    selected: activeVariationIds[ownProps.id]\r\n  }),\r\n  () => ({})\r\n)(Variation);\r\n","import React from \"react\";\r\nimport { connect } from \"react-redux\";\r\nimport CommentsColumnHeader from \"../CommentsColumn/CommentsColumnHeader/CommentsColumnHeader\";\r\nimport {\r\n  deselectComment,\r\n  deselectVariation,\r\n  selectVariation\r\n} from \"../redux/actions\";\r\nimport Variation from \"./Variation/Variation\";\r\nimport \"./VariationsColumn.css\";\r\n\r\nfunction VariationsColumn({ variations, onClickVariation, ...props }) {\r\n  return (\r\n    <div id=\"variations-column\" {...props}>\r\n      <CommentsColumnHeader\r\n        className=\"variations-header\"\r\n        headerText=\"Iterations\"\r\n      />\r\n      <div className=\"variations-scroll-column\">\r\n        {variations.map(variation => (\r\n          <Variation\r\n            key={variation.id}\r\n            onClick={() => onClickVariation(variation)}\r\n            {...variation}\r\n          />\r\n        ))}\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default connect(\r\n  ({ activeVariationIds, variations }) => ({ activeVariationIds, variations }),\r\n  dispatch => ({\r\n    selectVariation: variation => dispatch(selectVariation(variation)),\r\n    deselectVariation: variation => dispatch(deselectVariation(variation)),\r\n    deselectComment: () => dispatch(deselectComment())\r\n  }),\r\n  (\r\n    { activeVariationIds, ...stateProps },\r\n    { selectVariation, deselectVariation, deselectComment },\r\n    ownProps\r\n  ) => ({\r\n    ...ownProps,\r\n    ...stateProps,\r\n    onClickVariation: variation => {\r\n      deselectComment();\r\n      if (activeVariationIds[variation.id]) {\r\n        deselectVariation(variation);\r\n      } else {\r\n        selectVariation(variation);\r\n      }\r\n    }\r\n  })\r\n)(VariationsColumn);\r\n","import React from \"react\";\r\nimport ReactDOM from \"react-dom\";\r\nimport { connect, Provider } from \"react-redux\";\r\nimport CommentsColumn from \"./CommentsColumn/CommentsColumn\";\r\nimport DrawOver from \"./DrawOver/DrawOver\";\r\nimport Header from \"./Header/Header\";\r\nimport \"./index.css\";\r\nimport ModelRenderer from \"./ModelRenderer\";\r\nimport store from \"./redux/store\";\r\nimport {\r\n  deselectComment,\r\n  moveCamera,\r\n  showPins,\r\n  hidePins\r\n} from \"./redux/actions\";\r\nimport VariationsColumn from \"./VariationsColumn/VariationsColumn\";\r\n\r\nfunction MainPage({\r\n  cursor,\r\n  showPins,\r\n  activeVariations,\r\n  onClickEye,\r\n  onClickTopCamera,\r\n  onClickFrontCamera,\r\n  onClickSideCamera\r\n}) {\r\n  return (\r\n    <div id=\"app-container\" className={cursor}>\r\n      <Header eyeOpen={showPins} onClickEye={onClickEye} />\r\n      <div id=\"main-area\">\r\n        <VariationsColumn />\r\n        <DrawOver className=\"draw-over\">\r\n          <div className=\"renderer-row\">\r\n            {activeVariations.map(variation => (\r\n              <div\r\n                key={variation.id}\r\n                className=\"renderer\"\r\n                style={{\r\n                  width: `calc(100%/${activeVariations.length})`\r\n                }}\r\n              >\r\n                <ModelRenderer modelPath={variation.model} />\r\n              </div>\r\n            ))}\r\n          </div>\r\n          <div className=\"camera-button-row\">\r\n            <button\r\n              className=\"camera-button top-camera-button\"\r\n              onClick={onClickTopCamera}\r\n            >\r\n              <div className=\"camera-button-icon-container\">\r\n                <img src=\"assets/top-icon.svg\" alt=\"Top camera view icon\" />\r\n              </div>\r\n              Top\r\n            </button>\r\n            <button\r\n              className=\"camera-button front-camera-button\"\r\n              onClick={onClickFrontCamera}\r\n            >\r\n              <div className=\"camera-button-icon-container\">\r\n                <img src=\"assets/front-icon.svg\" alt=\"Top camera view icon\" />\r\n              </div>\r\n              Front\r\n            </button>\r\n            <button\r\n              className=\"camera-button side-camera-button\"\r\n              onClick={onClickSideCamera}\r\n            >\r\n              <div className=\"camera-button-icon-container\">\r\n                <img src=\"assets/side-icon.svg\" alt=\"Top camera view icon\" />\r\n              </div>\r\n              Side\r\n            </button>\r\n          </div>\r\n        </DrawOver>\r\n        <CommentsColumn />\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nconst WrappedMainPage = connect(\r\n  ({ cursor, activeVariationIds, variations, showPins }) => ({\r\n    cursor,\r\n    activeVariations: Object.keys(activeVariationIds)\r\n      .filter(id => activeVariationIds[id])\r\n      .map(variationId => variations.find(({ id }) => `${id}` === variationId)),\r\n    showPins\r\n  }),\r\n  dispatch => ({\r\n    onClickTopCamera: () => {\r\n      dispatch(deselectComment());\r\n      dispatch(moveCamera({ position: [0, 4, 0], focus: [0, 0, 0] }));\r\n    },\r\n    onClickFrontCamera: () => {\r\n      dispatch(deselectComment());\r\n      dispatch(moveCamera({ position: [0, 0, 4], focus: [0, 0, 0] }));\r\n    },\r\n    onClickSideCamera: () => {\r\n      dispatch(deselectComment());\r\n      dispatch(moveCamera({ position: [-4, 0, 0], focus: [0, 0, 0] }));\r\n    },\r\n    showPins: () => dispatch(showPins()),\r\n    hidePins: () => dispatch(hidePins())\r\n  }),\r\n  (stateProps, { showPins, hidePins, ...dispatchProps }, ownProps) => ({\r\n    ...ownProps,\r\n    ...stateProps,\r\n    ...dispatchProps,\r\n    onClickEye: () => {\r\n      if (stateProps.showPins) {\r\n        hidePins();\r\n      } else {\r\n        showPins();\r\n      }\r\n    }\r\n  })\r\n)(MainPage);\r\n\r\nReactDOM.render(\r\n  <Provider store={store}>\r\n    <WrappedMainPage />\r\n  </Provider>,\r\n  document.getElementById(\"root\")\r\n);\r\n"],"sourceRoot":""}